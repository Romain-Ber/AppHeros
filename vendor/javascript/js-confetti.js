function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||false;a.configurable=true;"value"in a&&(a.writable=true);Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){t&&_defineProperties(e.prototype,t);i&&_defineProperties(e,i);return e}function normalizeComputedStyleValue(e){return+e.replace(/px/,"")}function fixDPR(e){var t=window.devicePixelRatio;var i=getComputedStyle(e);var a=normalizeComputedStyleValue(i.getPropertyValue("width"));var n=normalizeComputedStyleValue(i.getPropertyValue("height"));e.setAttribute("width",(a*t).toString());e.setAttribute("height",(n*t).toString())}function generateRandomNumber(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;var a=Math.random()*(t-e)+e;return Math.floor(a*Math.pow(10,i))/Math.pow(10,i)}function generateRandomArrayElement(e){return e[generateRandomNumber(0,e.length)]}var e=.00125;var t=5e-4;var i=9e-4;var a=1e-5;var n=6;var o=80;var s=.9;var r=1.7;var h=.2;var c=.6;var l=.03;var u=.07;var d=15;var f=82;var m=150;var v=100;var p=250;var C=40;var g=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function getWindowWidthCoefficient(e){var t=1920;return Math.log(e)/Math.log(t)}var y=function(){function ConfettiShape(e){_classCallCheck(this,ConfettiShape);var a=e.initialPosition,n=e.direction,o=e.confettiRadius,v=e.confettiColors,p=e.emojis,C=e.emojiSize,g=e.canvasWidth;var y=generateRandomNumber(s,r,3);var b=y*getWindowWidthCoefficient(g);this.confettiSpeed={x:b,y:b};this.finalConfettiSpeedX=generateRandomNumber(h,c,3);this.rotationSpeed=p.length?.01:generateRandomNumber(l,u,3)*getWindowWidthCoefficient(g);this.dragForceCoefficient=generateRandomNumber(t,i,6);this.radius={x:o,y:o};this.initialRadius=o;this.rotationAngle=n==="left"?generateRandomNumber(0,.2,3):generateRandomNumber(-.2,0,3);this.emojiSize=C;this.emojiRotationAngle=generateRandomNumber(0,2*Math.PI);this.radiusYUpdateDirection="down";var S=n==="left"?generateRandomNumber(f,d)*Math.PI/180:generateRandomNumber(-d,-f)*Math.PI/180;this.absCos=Math.abs(Math.cos(S));this.absSin=Math.abs(Math.sin(S));var R=generateRandomNumber(-m,0);var P={x:a.x+(n==="left"?-R:R)*this.absCos,y:a.y-R*this.absSin};this.currentPosition=Object.assign({},P);this.initialPosition=Object.assign({},P);this.color=p.length?null:generateRandomArrayElement(v);this.emoji=p.length?generateRandomArrayElement(p):null;this.createdAt=(new Date).getTime();this.direction=n}_createClass(ConfettiShape,[{key:"draw",value:function draw(e){var t=this.currentPosition,i=this.radius,a=this.color,n=this.emoji,o=this.rotationAngle,s=this.emojiRotationAngle,r=this.emojiSize;var h=window.devicePixelRatio;if(a){e.fillStyle=a;e.beginPath();e.ellipse(t.x*h,t.y*h,i.x*h,i.y*h,o,0,2*Math.PI);e.fill()}else if(n){e.font="".concat(r,"px serif");e.save();e.translate(h*t.x,h*t.y);e.rotate(s);e.textAlign="center";e.fillText(n,0,0);e.restore()}}},{key:"updatePosition",value:function updatePosition(t,i){var n=this.confettiSpeed,o=this.dragForceCoefficient,s=this.finalConfettiSpeedX,r=this.radiusYUpdateDirection,h=this.rotationSpeed,c=this.createdAt,l=this.direction;var u=i-c;n.x>s&&(this.confettiSpeed.x-=o*t);this.currentPosition.x+=n.x*(l==="left"?-this.absCos:this.absCos)*t;this.currentPosition.y=this.initialPosition.y-n.y*this.absSin*u+e*Math.pow(u,2)/2;this.rotationSpeed-=this.emoji?1e-4:a*t;this.rotationSpeed<0&&(this.rotationSpeed=0);if(this.emoji)this.emojiRotationAngle+=this.rotationSpeed*t%(2*Math.PI);else if(r==="down"){this.radius.y-=t*h;if(this.radius.y<=0){this.radius.y=0;this.radiusYUpdateDirection="up"}}else{this.radius.y+=t*h;if(this.radius.y>=this.initialRadius){this.radius.y=this.initialRadius;this.radiusYUpdateDirection="down"}}}},{key:"getIsVisibleOnCanvas",value:function getIsVisibleOnCanvas(e){return this.currentPosition.y<e+v}}]);return ConfettiShape}();function createCanvas(){var e=document.createElement("canvas");e.style.position="fixed";e.style.width="100%";e.style.height="100%";e.style.top="0";e.style.left="0";e.style.zIndex="1000";e.style.pointerEvents="none";document.body.appendChild(e);return e}function normalizeConfettiConfig(e){var t=e.confettiRadius,i=t===void 0?n:t,a=e.confettiNumber,s=a===void 0?e.confettiesNumber||(e.emojis?C:p):a,r=e.confettiColors,h=r===void 0?g:r,c=e.emojis,l=c===void 0?e.emojies||[]:c,u=e.emojiSize,d=u===void 0?o:u;e.emojies&&console.error("emojies argument is deprecated, please use emojis instead");e.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead");return{confettiRadius:i,confettiNumber:s,confettiColors:h,emojis:l,emojiSize:d}}var b=function(){function ConfettiBatch(e){var t=this;_classCallCheck(this,ConfettiBatch);this.canvasContext=e;this.shapes=[];this.promise=new Promise((function(e){return t.resolvePromise=e}))}_createClass(ConfettiBatch,[{key:"getBatchCompletePromise",value:function getBatchCompletePromise(){return this.promise}},{key:"addShapes",value:function addShapes(){var e;(e=this.shapes).push.apply(e,arguments)}},{key:"complete",value:function complete(){var e;if(this.shapes.length)return false;(e=this.resolvePromise)===null||e===void 0?void 0:e.call(this);return true}},{key:"processShapes",value:function processShapes(e,t,i){var a=this;var n=e.timeDelta,o=e.currentTime;this.shapes=this.shapes.filter((function(e){e.updatePosition(n,o);e.draw(a.canvasContext);return!i||e.getIsVisibleOnCanvas(t)}))}}]);return ConfettiBatch}();var S=function(){function JSConfetti(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classCallCheck(this,JSConfetti);this.activeConfettiBatches=[];this.canvas=e.canvas||createCanvas();this.canvasContext=this.canvas.getContext("2d");this.requestAnimationFrameRequested=false;this.lastUpdated=(new Date).getTime();this.iterationIndex=0;this.loop=this.loop.bind(this);requestAnimationFrame(this.loop)}_createClass(JSConfetti,[{key:"loop",value:function loop(){this.requestAnimationFrameRequested=false;fixDPR(this.canvas);var e=(new Date).getTime();var t=e-this.lastUpdated;var i=this.canvas.offsetHeight;var a=this.iterationIndex%10===0;this.activeConfettiBatches=this.activeConfettiBatches.filter((function(n){n.processShapes({timeDelta:t,currentTime:e},i,a);return!a||!n.complete()}));this.iterationIndex++;this.queueAnimationFrameIfNeeded(e)}},{key:"queueAnimationFrameIfNeeded",value:function queueAnimationFrameIfNeeded(e){if(!this.requestAnimationFrameRequested&&!(this.activeConfettiBatches.length<1)){this.requestAnimationFrameRequested=true;this.lastUpdated=e||(new Date).getTime();requestAnimationFrame(this.loop)}}},{key:"addConfetti",value:function addConfetti(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var t=normalizeConfettiConfig(e),i=t.confettiRadius,a=t.confettiNumber,n=t.confettiColors,o=t.emojis,s=t.emojiSize;var r=this.canvas.getBoundingClientRect();var h=r.width;var c=r.height;var l=c*5/7;var u={x:0,y:l};var d={x:h,y:l};var f=new b(this.canvasContext);for(var m=0;m<a/2;m++){var v=new y({initialPosition:u,direction:"right",confettiRadius:i,confettiColors:n,confettiNumber:a,emojis:o,emojiSize:s,canvasWidth:h});var p=new y({initialPosition:d,direction:"left",confettiRadius:i,confettiColors:n,confettiNumber:a,emojis:o,emojiSize:s,canvasWidth:h});f.addShapes(v,p)}this.activeConfettiBatches.push(f);this.queueAnimationFrameIfNeeded();return f.getBatchCompletePromise()}},{key:"clearCanvas",value:function clearCanvas(){this.activeConfettiBatches=[]}},{key:"destroyCanvas",value:function destroyCanvas(){this.canvas.remove()}}]);return JSConfetti}();export{S as default};

